# ラボ 0301: 構成プロファイルの作成と展開



## 概要



このラボでは、Microsoft Intune を使用して、Windows 11 デバイスの構成プロファイルを作成して適用します。

### 前提 条件



このラボの前に、次のラボを完了する必要があります。

- 0101 - Entra IDでのアイデンティティの管理

- 0102 - Entra Connect を使用した ID の同期

- 0203-Intuneへのデバイス登録の管理

- 0204-Intune へのデバイスの登録

  > 注: Entra ID への Windows Hello サインイン認証をセキュリティで保護するために使用されるテキスト メッセージを受信できる携帯電話も必要です。

## 演習 1: 構成プロファイルを作成して適用する



### シナリオ



Entra と Intune を使用して、Contoso の開発者部門のメンバーを管理する必要があります。ユーザーが Windows 11 デバイスで効果的かつ安全に作業できるようにするソリューションを評価するよう求められています。Aaron Nicholls は、ソリューションのテストと評価、フィードバックの提供をボランティアで支援しています。また、開発者の Windows デバイスに含めて適用する必要がある初期要件もいくつか示しました。

- [設定] の [ゲーム] セクションは表示されません。
- 設定のプライバシーセクションは、可能な限り制限する必要があります。
- C:\DevProjects フォルダーは、Windows Defender から除外する必要があります。
- プロセスdevbuild.exeは、Windows Defender から除外する必要があります。
- 最も使用されているアプリと最近追加したアプリは、[スタート] メニューに表示されません。

### タスク 1: デバイス設定を確認する



1. PIN **102938**を使用して **Aaron Nicholls** として **SEA-WS1** にサインインします。
2. タスク バーで、[**Start （Windowsアイコン）]** を選択し、[**Settings]** を選択します。
3. [**Settings**] ナビゲーション リストで、[**Gaming]** 設定が表示されることを確認します。
4. **Personalization** を選択し、Personalization ページで **Start** を選択します。[**Show recently added apps**] と [**Show most used apps**] の両方が **[On**] に設定されていることを確認します。(そうでない場合は両方Onに設定してください)
5. **Settings**アプリで、[**Privacy & security]** を選択します。
6. [**Privacy & security**] ページで、[**Security**] セクション、[**Windows permissions**] セクション、および [**App permissions**] セクションで使用可能なオプションを確認します。
7. [**Privacy & security**] ページで、[**Windows Security**] を選択し、[**Open Windows Security]** を選択します。
8. [**Windows Security**] ページで、[**Virus & threat protection**] を選択します。
9. [**Virus & threat protection**] ページの [**Virus & threat protection settings**] で、[**Manage settings]** を選択します。
10. [**Exclusions**] まで下にスクロールし、[**Add or remove exclusions]** を選択します。[User Account Control] で、[**Yes**] を選択します。
11. [**Exclusions**] ページで、除外が構成されていないことを確認します。
12. **[Windows Security**] ウィンドウを閉じます。
13. **[Settings**]ウィンドウを閉じます。

### タスク2: シナリオ要件に基づく構成プロファイルの作成

1. ブラウザーで、アドレス バーに「**[https://intune.microsoft.com](https://intune.microsoft.com/)**」と入力し、**Enter キー**を押します。
4. テナント管理者パスワードを使用して **`admin@yourtenant.onmicrosoft.com`** としてサインインします。
5. Microsoft Intune管理センターで、ナビゲーション バーから **[デバイス]** を選択します。
6. [**デバイス]** ページの [**デバイスの管理]** セクションで、[**構成]** を選択します。
7. **デバイス |構成**ブレードの詳細ウィンドウで、 **[+ 作成]** を選択し、 [**+ 新しいポリシー**] を選択します。
8. [**プロファイルの作成**] ブレードで、次のオプションを選択し、 **[作成]** を選択します。
   - プラットフォーム: **Windows 10 以降**
   - プロファイルタイプ: **テンプレート**
   - テンプレート名: **デバイスの制限**
9. **基本** タブで、次の情報を入力し、**次へ** を選択します。

- 名前: **Contoso Developer - standard**
- 説明: **Contoso 開発者向けの基本的な制限と構成。**

1. [**構成設定**] タブで、[**コントロール パネルと設定**] を展開します。

2. [**ゲーム]** と **[プライバシー**] の横にある **[ブロック]** をそれぞれ選択します。

3. 同じ画面にある **[開始]** を展開します。

4. 下にスクロールして、[**最もよく使用されるアプリ**]、[**最近追加したアプリ**]、[**ジャンプ リストで最近開いたアイテム**] の横にある **[ブロック**] をそれぞれ選択します。

5. 同じ画面にある  **[Microsoft Defender ウイルス対策**] を展開します。

6. 下にスクロールして [**Microsoft Defender ウイルス対策の除外**] を展開します。

7.  **[Microsoft Defender ウイルス対策の除外**]の[**ファイルとフォルダー]** ボックスで、次のように入力します。

   **C:\DevProjects** (日本語環境であれば、\は円マークで表示されます。)

8. [**プロセス]** ボックスに、次のように入力します。**DevBuild.exe**

9. [**確認および作成**] ブレードに到達するまで、 **[次へ**] を 3 回選択します。**[作成]** を選択します。

### タスク 3: Contoso Developer デバイス グループを作成する

1. Microsoft Intune管理センターのナビゲーション ウィンドウで、[**グループ]** を選択します。
2. **グループ |概要** ブレードで、 [**新しいグループ**] を選択します。
3. [**新しいグループ**] ブレードで、次の情報を入力します。

- グループの種類: **セキュリティ**
- グループ名: **Contoso Developer devices**
- グループの説明: **Contoso 開発者部門のすべての Windows デバイス**
- メンバーシップの種類: **割り当て済み**

1. **[メンバー]** で、[**メンバーが選択されていません**] を選択します。
2. [**メンバーの追加**] ブレードの [**検索]** ボックスに「**Sea**」と入力します。[**SEA-WS1**] のチェックボックスを **オン** にして、[**選択]** を選択します。
3. [**新しいグループ**] ブレードで、 **[作成]** を選択します。
4. **[すべてのグループ]** をクリックし、**Contoso Developer devices** グループが表示されることを確認します。

### タスク4: 動的Entra IDデバイス・グループの作成

1. **グループ |[すべてのグループ]** ブレードの詳細ウィンドウで、 [**新しいグループ**] を選択します。
2. [**グループ**] ブレードで、次の値を指定します。
   - グループの種類: **セキュリティ**
   - グループ名: **Windows Device**
   - メンバーシップタイプ:**動的デバイス**
3. [**動的デバイス メンバー]** セクションで、[**動的クエリの追加**] を選択します。
4. [**動的メンバーシップ ルール]** ブレードの **[ルール構文]** セクションで、 **[編集]** を選択します。
5. **[ルール構文の編集]** テキスト ボックスに、次の単純なメンバーシップ ルールを追加し、[**OK]** を選択します。

   ```
   (device.deviceOSType -contains "Windows")
   ```

6. [**動的メンバーシップ ルール]** ブレードで、 [**保存]** を選択します。

7. 新しい**グループ** ページで、**作成** を選択します。

### タスク5: Windowsデバイスへの構成プロファイルの割り当て

1. Microsoft Intune管理センターのナビゲーション ウィンドウで、[**デバイス]** を選択します。
2. [**デバイス]** ブレードの **[デバイスの管理]** セクションで、 **[構成]** を選択します。
3. **デバイス |[構成**] ブレードの詳細ウィンドウで、**Contoso Developer – standard** プロファイルを選択します。
4. **[Contoso Developer – standard**] ブレードで、[**割り当て]** セクションまで下にスクロールし、 **[編集]** を選択します。
5. [割り当て] ページの **[組み込まれたグループ]** で **[グループの追加**] を選択します。
6. [**含めるグループの選択]** ブレードの [**検索**] ボックスで、 **[Contoso Developer devices**] をのチェックボックスを **オン** にして、[**選択]** を選択します。
7. [**デバイスの制限**] ブレードに戻り、 [**レビューと保存**] を選択し、 [**保存]** を選択します。
8. Microsoft Intune管理センターで、メニューの **[デバイス]** を選択します。

### タスク6: 構成プロファイルが適用されていることを確認する

1. **SEA-WS1** に切り替えます。

2. タスク バーで、[**Start （Windowsアイコン）]** を選択し、[**Settings]** を選択します。

3. **[Settings]** で **[Accounts**] を選択し、[**Access work or school**] を選択します。

4. [**Access work or school**] セクションで、 **[Connected to Contoso's Azure AD]** を選択し、 [**Info**] を選択します。

5. [**Managed by Contoso]** ページで、下にスクロールし、 [Device Sync Status] で **[Sync]** を選択します。同期が完了するまで待ちます。

6. 同期が完了したら、**Settings**アプリを閉じます。

   ※ 以下の手順は動作確認となります。想定通りの結果になっていない場合は、数分時間をおいて再確認や再Sync等を試してみてください。

7. **SEA-WS1** で、[**Start （Windowsアイコン）]** を選択し、[**Settings]** を選択します。**[Gaming]** 設定が削除されていることを確認します。

8. **[Privacy & Security]** を選択すると、プライバシー設定の多くが非表示になっていることがわかります。

9. [**Personalization]** を選択し、[**Start]** を選択します。[**Show recently added apps**] と [**Show most used apps**] が **[Off]** に設定されていることを確認します。

10. **Settings** アプリで、[**Privacy & Security]** を選択します。

11. [**Privacy & Security**] ページで、[**Windows Security**] を選択し、[**Open Windows Security]** を選択します。

12. [**Windows Security**] ページで、[**Virus & threat protection**] を選択します。

13. [**Virus & threat protection**] ページで、[**Virus & threat protection settings**] の [**Manage settings**] を選択します。

14. [**Exclusions**] まで下にスクロールし、[**Add or remove exclusions]** を選択します。[User Account Control] メッセージで [**Yes**] を選択します。

15. [**Exclusions**] ページで、**C:\DevProjects** と **DevBuild.exe** が表示されていることを確認します。

16. **Windows Security** ページを閉じてから、**Settings**アプリを閉じます。

**結果**: この演習を完了すると、Windows 11 デバイスの構成プロファイルが正常に作成され、割り当てられます。



## 演習 2: 割り当てられた構成プロファイル ポリシーを変更する

### シナリオ

Contoso のポリシーには、開発者部門のメンバーがデバイスの [設定] で [プライバシー] オプションをブロックしてはならないと指定する例外がありました。この変更は実装され、テストされる必要があります。

### タスク 1: 割り当てられた構成プロファイルの設定を変更する

1. ブラウザー の Microsoft Intune 管理センターで **[デバイス]** を選択し、[**デバイスの管理]** セクションで **[構成]** を選択します。
3. **デバイス |構成**ブレードの詳細ウィンドウで、 **[Contoso Developer - standard**] を選択します。
4. **[Contoso Developer - standard**] ブレードで、[**構成設定**] セクションまで下にスクロールし、[**編集]** を選択します。
5. [**デバイスの制限**] ページで、[**コントロール パネルと設定]** を展開します。
6. [**プライバシー]** の横にある [**構成されていません]** を選択します。
7. [**レビューと保存**] を選択し、 [**保存]** を選択します。

### タスク 2: Intune Manager 管理センターからのデバイス同期を強制する

1. Microsoft Intune管理センターで、ナビゲーション ウィンドウで **[デバイス]** を選択し、[**すべてのデバイス**] を選択します。

2. 詳細ペインで、[**SEA-WS1**] を選択します。

3. [**SEA-WS1**] ブレードで **[同期]** を選択し、プロンプトが表示されたら [**はい**] を選択します。

   *注: Intune はデバイスに接続し、すべてのポリシーを同期するように指示します。これには最大 5 分かかる場合があります。*

### タスク 3: SEA-WS1 の変更の確認

1. **SEA-WS1** に切り替えます。
2. **SEA-WS1** とタスク バーで、[**Start]** を選択し、[**Settings**] アプリを選択します。
3. **Settings**アプリで、[**Privacy & security]** を選択し、すべてのカスタマイズ オプションが戻っていることを確認します。
4. 開いているすべてのウィンドウを閉じて、**SEA-WS1** からサインアウトします。

**結果**: この演習を完了すると、割り当てられた構成プロファイルを変更し、構成プロファイルを変更し、変更を検証できます。

**ラボの終わり**
